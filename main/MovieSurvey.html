{{ block title }}
Movie {{ movie_number }} of {{ total_movies }}
{{ endblock }}

{{ block styles }}
<link href="https://unpkg.com/survey-jquery@1.12.18/defaultV2.min.css" rel="stylesheet">
<style>
    .movie-card {
        max-width: 760px;
        border: 1px solid #d6d9dd;
    }

    .movie-poster {
        max-width: 320px;
        width: 100%;
        border: 2px solid #cfd4da;
        border-radius: 10px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.18);
    }

    .synopsis-box {
        max-width: 640px;
        background: #f8f9fa;
        border: 1px solid #d6d9dd;
        border-radius: 10px;
        box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.6);
    }

    .survey-card {
        max-width: 860px;
        border: 1px solid #d6d9dd;
    }

    .sv-root-modern .sv-btn {
        background-color: #0d6efd;
        color: #fff;
    }
</style>
{{ endblock }}

{{ block content }}
<div class="text-center mb-3">
    <span class="badge text-bg-primary">Movie {{ movie_number }} of {{ total_movies }}</span>
</div>

<div class="card movie-card shadow-sm mx-auto">
    <div class="card-body text-center p-4">
        <h3 class="mb-1">{{ movie.title }}</h3>
        <p class="text-secondary mb-3">{{ movie.category }}</p>

        <img src="{{ movie_image_url }}" alt="{{ movie.title }} poster" class="movie-poster img-fluid">

        <div class="synopsis-box mx-auto mt-4 p-3 text-start">
            <div class="text-uppercase fw-semibold text-primary small mb-2">Movie Description</div>
            <p class="mb-0">{{ movie.synopsis }}</p>
        </div>
    </div>
</div>

<div class="card survey-card shadow-sm mx-auto mt-4">
    <div class="card-body p-4">
        <div id="surveyContainer"></div>
    </div>
</div>

<input type="hidden" id="surveyResults" name="surveyResults" value="">
{{ endblock }}

{{ block scripts }}
<script src="https://unpkg.com/jquery@3.7.1/dist/jquery.min.js"></script>
<script src="https://unpkg.com/survey-jquery@1.12.18/survey.jquery.min.js"></script>
<script>
    const survey = new Survey.Model(js_vars.survey_json);
    Survey.StylesManager.applyTheme("bootstrap");
    survey.showCompletedPage = false;

    survey.onComplete.add(function (sender) {
        document.getElementById('surveyResults').value = JSON.stringify(sender.data);
        document.getElementById('form').submit();
    });

    $("#surveyContainer").Survey({model: survey});
</script>
{{ endblock }}
